{
  "hash": "add260c5c2c7251893704390d396b1ca",
  "result": {
    "markdown": "---\ntitle: \"\"\ndescription: \"Methods for dealing with overlapping points and then styling a leaflet map with various labels and pop-ups.\"\ntwitter-card:\n  image: \"thumbnail.jpg\"\nauthor:\n  - name: Louise E. Sinks\n    url: https://lsinks.github.io/\ndate: 09-05-2023\ncategories: [Data-Viz, R, R-code,  Code-Along, s] # self-defined categories\ncitation:\n  url: https://lsinks.github.io/posts/\nimage: \"thumbnail.jpg\"\ndraft: true # setting this to `true` will prevent your post from appearing on your listing page until you're ready\n---\n\n\n# Intro/Overview\n\nThis week's TidyTuesday presents data taken from the [Union Membership and Coverage Database from the CPS (*Unionstats.com*)](https://www.unionstats.com/main.htm) created by Barry T. Hirsch, David A. Macpherson, and William E. Even. This database contains data about the wages of union and non-union workers from 1973 until today.\n\nThere is a [companion paper](https://onlinelibrary.wiley.com/doi/10.1111/irel.12330):\n\n> Macpherson, David A. and Barry T. Hirsch. 2023. \"Five decades of CPS wages, methods, and union-nonunion wage gaps at Unionstats.com.\" Industrial Relations: A Journal of Economy and Society 62: 439--452. https://doi.org/10.1111/ irel.12330\n\nI highly recommend reading the paper as it clearly illustrates the challenges of working with real world data collected by 3rd parties. The source data is government survey data. For some key questions, a third of respondants didn't answer. Imputation was performed (but not always noted) by the government agency, but in such a way that it obscured the trend about wage gaps between union and non-union labor. (Likely the survey was designed to study something else, and the method of imputation was fine for that question. Some years did not even ask about participation in labor unions.) The survey also didn't always collected detailed information about the salary of highest earners, simply marking them as being \"above the cap\". The paper details numerous such issues and explains how the data was handled to standardize the results over the 5 decades the database covers. It is a beautiful example on how to handle messy data.\n\n# Setting Up\n\n## Loading Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # who doesn't want to be tidy?\nlibrary(gt) # for nice tables\nlibrary(treemap)\nlibrary(d3treeR)\n```\n:::\n\n\n## Loading Data\n\nThis week's data is not loaded in the usual way! While the TidyTuesday page was up on Monday, the TidyTuesday package insisted the data was not available by either week number or date. So, instead, I loaded it directly from github.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemographics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-09-05/demographics.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 1327 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): facet\ndbl (7): year, sample_size, employment, members, covered, p_members, p_covered\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nwages <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-09-05/wages.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 1247 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): facet\ndbl (8): year, sample_size, wage, at_cap, union_wage, nonunion_wage, union_w...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nstates <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-09-05/states.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 10200 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): state, sector, state_abbreviation\ndbl (8): state_census_code, observations, employment, members, covered, p_me...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nI noticed that figure 2 in the paper had the wage gap graphed by a variety of different categories, ranging from sector to demographics. I thought re-creating this figure by related subgroups might be interesting. Looking at the wage data, you can see the variety of information types stored in the facet variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwages_2019 <- wages %>%\n  filter(year == 2019) \n\nwages_2019 %>% select(facet) %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"pgllaotndr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pgllaotndr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pgllaotndr thead, #pgllaotndr tbody, #pgllaotndr tfoot, #pgllaotndr tr, #pgllaotndr td, #pgllaotndr th {\n  border-style: none;\n}\n\n#pgllaotndr p {\n  margin: 0;\n  padding: 0;\n}\n\n#pgllaotndr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pgllaotndr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pgllaotndr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pgllaotndr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pgllaotndr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pgllaotndr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pgllaotndr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pgllaotndr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pgllaotndr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pgllaotndr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pgllaotndr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pgllaotndr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pgllaotndr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pgllaotndr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pgllaotndr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pgllaotndr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pgllaotndr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pgllaotndr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pgllaotndr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pgllaotndr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pgllaotndr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pgllaotndr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pgllaotndr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pgllaotndr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pgllaotndr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pgllaotndr .gt_left {\n  text-align: left;\n}\n\n#pgllaotndr .gt_center {\n  text-align: center;\n}\n\n#pgllaotndr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pgllaotndr .gt_font_normal {\n  font-weight: normal;\n}\n\n#pgllaotndr .gt_font_bold {\n  font-weight: bold;\n}\n\n#pgllaotndr .gt_font_italic {\n  font-style: italic;\n}\n\n#pgllaotndr .gt_super {\n  font-size: 65%;\n}\n\n#pgllaotndr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pgllaotndr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pgllaotndr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pgllaotndr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pgllaotndr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pgllaotndr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pgllaotndr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"facet\">facet</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">all wage and salary workers</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">construction</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">all wage and salary workers</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">wholesale/retail</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">all wage and salary workers</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">all wage and salary workers</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">all wage and salary workers</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">public administration</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">private sector: all</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">private sector: nonagricultural</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">private sector: construction</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">private sector: manufacturing</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">public sector: all</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">public sector: federal</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">public sector: state government</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">public sector: local government</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: less than college</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: college or more</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: male</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: female</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: white male</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: white female</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: black male</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: black female</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: hispanic male</td></tr>\n    <tr><td headers=\"facet\" class=\"gt_row gt_left\">demographics: hispanic female</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nInterestingly, the overall data (\"all wage and salary workers\") appears 5 times.\n\nDemographic Data only\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwages_2019_demo <- wages_2019 %>%\n  filter(str_detect(facet , \"demographics\") == TRUE | str_detect(facet, \"all wage and salary workers\") == TRUE)\n```\n:::\n\n\nRemove the first 4 rows and the college info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwages_2019_demo2 <- wages_2019_demo[5:15,  ] \n\nwages_2019_demo2 <- wages_2019_demo2 %>%\n  filter(str_detect(facet , \"college\") == FALSE)\n\nwages_2019_demo2 %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"ztpigbxhfr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ztpigbxhfr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ztpigbxhfr thead, #ztpigbxhfr tbody, #ztpigbxhfr tfoot, #ztpigbxhfr tr, #ztpigbxhfr td, #ztpigbxhfr th {\n  border-style: none;\n}\n\n#ztpigbxhfr p {\n  margin: 0;\n  padding: 0;\n}\n\n#ztpigbxhfr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ztpigbxhfr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ztpigbxhfr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ztpigbxhfr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ztpigbxhfr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ztpigbxhfr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ztpigbxhfr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ztpigbxhfr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ztpigbxhfr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ztpigbxhfr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ztpigbxhfr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ztpigbxhfr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ztpigbxhfr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ztpigbxhfr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ztpigbxhfr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ztpigbxhfr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ztpigbxhfr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ztpigbxhfr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ztpigbxhfr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ztpigbxhfr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ztpigbxhfr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ztpigbxhfr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ztpigbxhfr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ztpigbxhfr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ztpigbxhfr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ztpigbxhfr .gt_left {\n  text-align: left;\n}\n\n#ztpigbxhfr .gt_center {\n  text-align: center;\n}\n\n#ztpigbxhfr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ztpigbxhfr .gt_font_normal {\n  font-weight: normal;\n}\n\n#ztpigbxhfr .gt_font_bold {\n  font-weight: bold;\n}\n\n#ztpigbxhfr .gt_font_italic {\n  font-style: italic;\n}\n\n#ztpigbxhfr .gt_super {\n  font-size: 65%;\n}\n\n#ztpigbxhfr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ztpigbxhfr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ztpigbxhfr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ztpigbxhfr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ztpigbxhfr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ztpigbxhfr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ztpigbxhfr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"year\">year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sample_size\">sample_size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"wage\">wage</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"at_cap\">at_cap</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"union_wage\">union_wage</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nonunion_wage\">nonunion_wage</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"union_wage_premium_raw\">union_wage_premium_raw</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"union_wage_premium_adjusted\">union_wage_premium_adjusted</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"facet\">facet</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">94818</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">28.09587</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.05071279</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">31.70222</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">27.64805</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.14663510</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.14290078</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">all wage and salary workers</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">48157</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">31.31306</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.07093566</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">34.02119</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">30.96146</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.09882383</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.17838623</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">46661</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">24.64259</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02903222</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">28.99576</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">24.12817</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.20173885</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.10255232</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: female</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">40352</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">31.72107</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.07324656</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">34.46735</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">31.36370</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.09895673</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.17714998</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: white male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">37864</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">24.57163</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02741190</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">28.91303</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">24.06818</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.20129693</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.09296709</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: white female</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">3607</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">23.72498</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02696504</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">30.11012</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">22.74304</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.32392681</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.17447826</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: black male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">4577</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">21.96607</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02158116</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">26.77524</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">21.29592</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.25729427</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.14210089</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: black female</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">6897</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">22.11324</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02291996</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">30.18838</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">21.20103</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.42391109</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.24975224</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: hispanic male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">5947</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">18.81279</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.01247475</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">25.42001</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">18.14904</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.40062550</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.15435517</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: hispanic female</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nLet's remove \"demographics:\" and all jobs\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwages_2019_demo3 <- wages_2019_demo2[2:9,  ] \n\nwages_2019_demo3 <- wages_2019_demo3 %>%\n  mutate(facet= str_replace_all(facet, \"demographics: \", \"\")) %>%\n  separate(facet, c(\"ethnicity\", \"sex\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expected 2 pieces. Missing pieces filled with `NA` in 2 rows [1, 2].\n```\n:::\n\n```{.r .cell-code}\nwages_2019_demo2 %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"bomtddalih\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bomtddalih table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bomtddalih thead, #bomtddalih tbody, #bomtddalih tfoot, #bomtddalih tr, #bomtddalih td, #bomtddalih th {\n  border-style: none;\n}\n\n#bomtddalih p {\n  margin: 0;\n  padding: 0;\n}\n\n#bomtddalih .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bomtddalih .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bomtddalih .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bomtddalih .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bomtddalih .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bomtddalih .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bomtddalih .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bomtddalih .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bomtddalih .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bomtddalih .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bomtddalih .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bomtddalih .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bomtddalih .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bomtddalih .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bomtddalih .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bomtddalih .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bomtddalih .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bomtddalih .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bomtddalih .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bomtddalih .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bomtddalih .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bomtddalih .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bomtddalih .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bomtddalih .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bomtddalih .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bomtddalih .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bomtddalih .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bomtddalih .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bomtddalih .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bomtddalih .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bomtddalih .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bomtddalih .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bomtddalih .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bomtddalih .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bomtddalih .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bomtddalih .gt_left {\n  text-align: left;\n}\n\n#bomtddalih .gt_center {\n  text-align: center;\n}\n\n#bomtddalih .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bomtddalih .gt_font_normal {\n  font-weight: normal;\n}\n\n#bomtddalih .gt_font_bold {\n  font-weight: bold;\n}\n\n#bomtddalih .gt_font_italic {\n  font-style: italic;\n}\n\n#bomtddalih .gt_super {\n  font-size: 65%;\n}\n\n#bomtddalih .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bomtddalih .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bomtddalih .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bomtddalih .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bomtddalih .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bomtddalih .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bomtddalih .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"year\">year</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sample_size\">sample_size</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"wage\">wage</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"at_cap\">at_cap</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"union_wage\">union_wage</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nonunion_wage\">nonunion_wage</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"union_wage_premium_raw\">union_wage_premium_raw</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"union_wage_premium_adjusted\">union_wage_premium_adjusted</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"facet\">facet</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">94818</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">28.09587</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.05071279</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">31.70222</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">27.64805</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.14663510</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.14290078</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">all wage and salary workers</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">48157</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">31.31306</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.07093566</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">34.02119</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">30.96146</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.09882383</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.17838623</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">46661</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">24.64259</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02903222</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">28.99576</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">24.12817</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.20173885</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.10255232</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: female</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">40352</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">31.72107</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.07324656</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">34.46735</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">31.36370</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.09895673</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.17714998</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: white male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">37864</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">24.57163</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02741190</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">28.91303</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">24.06818</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.20129693</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.09296709</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: white female</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">3607</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">23.72498</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02696504</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">30.11012</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">22.74304</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.32392681</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.17447826</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: black male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">4577</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">21.96607</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02158116</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">26.77524</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">21.29592</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.25729427</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.14210089</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: black female</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">6897</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">22.11324</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.02291996</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">30.18838</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">21.20103</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.42391109</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.24975224</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: hispanic male</td></tr>\n    <tr><td headers=\"year\" class=\"gt_row gt_right\">2019</td>\n<td headers=\"sample_size\" class=\"gt_row gt_right\">5947</td>\n<td headers=\"wage\" class=\"gt_row gt_right\">18.81279</td>\n<td headers=\"at_cap\" class=\"gt_row gt_right\">0.01247475</td>\n<td headers=\"union_wage\" class=\"gt_row gt_right\">25.42001</td>\n<td headers=\"nonunion_wage\" class=\"gt_row gt_right\">18.14904</td>\n<td headers=\"union_wage_premium_raw\" class=\"gt_row gt_right\">0.40062550</td>\n<td headers=\"union_wage_premium_adjusted\" class=\"gt_row gt_right\">0.15435517</td>\n<td headers=\"facet\" class=\"gt_row gt_left\">demographics: hispanic female</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nnow we don't need male and female except to check the numbers. Which don't add up. Male + female does equal the total number of workers, but the individual subgroups of male and female don't add up to the totals (hispanic male + white male + black male \\> male).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwages_2019_demo3a <- wages_2019_demo3[3:8, ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntreemap(wages_2019_demo3a,\n            index=c(\"sex\",\"ethnicity\"),\n            vSize=\"sample_size\",\n            type=\"index\", bg.labels=c(\"white\"),\n            align.labels=list(\n              c(\"center\", \"center\"), \n              c(\"right\", \"bottom\")\n            ) \n            ) \n```\n\n::: {.cell-output-display}\n![](labor_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nInstall via\n\n```         \ndevtools::install_github(\"d3treeR/d3treeR\")\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- treemap(wages_2019_demo3a,\n            index=c(\"sex\",\"ethnicity\"),\n            vSize=\"sample_size\",\n            type=\"index\",\n            bg.labels=c(\"white\"),\n            align.labels=list(\n              c(\"center\", \"center\"), \n              c(\"right\", \"bottom\")\n            ),\n            title = \"Sample Size of Workers\", \n          )     \n```\n\n::: {.cell-output-display}\n![](labor_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\np\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$tm\n     sex ethnicity vSize vColor stdErr vColorValue level        x0        y0\n1 female     black  4577      1   4577          NA     2 0.7879523 0.0000000\n2 female  hispanic  5947      1   5947          NA     2 0.5124340 0.0000000\n3 female      <NA> 48388      3  48388          NA     1 0.5124340 0.0000000\n4 female     white 37864      1  37864          NA     2 0.5124340 0.2174919\n5   male     black  3607      1   3607          NA     2 0.3364678 0.0000000\n6   male  hispanic  6897      1   6897          NA     2 0.0000000 0.0000000\n7   male      <NA> 50856      3  50856          NA     1 0.0000000 0.0000000\n8   male     white 40352      1  40352          NA     2 0.0000000 0.2065440\n          w         h   color\n1 0.2120477 0.2174919 #919710\n2 0.2755183 0.2174919 #00A76E\n3 0.4875660 1.0000000 #7EBA68\n4 0.4875660 0.7825081 #60A040\n5 0.1759662 0.2065440 #D26FAF\n6 0.3364678 0.2065440 #9087D7\n7 0.5124340 1.0000000 #D494E1\n8 0.5124340 0.7934560 #BD76CB\n\n$type\n[1] \"index\"\n\n$vSize\n[1] \"sample_size\"\n\n$vColor\n[1] NA\n\n$stdErr\n[1] \"sample_size\"\n\n$algorithm\n[1] \"pivotSize\"\n\n$vpCoorX\n[1] 0.02812148 0.97187852\n\n$vpCoorY\n[1] 0.01968504 0.91031496\n\n$aspRatio\n[1] 1.483512\n\n$range\n[1] NA\n\n$mapping\n[1] NA NA NA\n\n$draw\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\n# make it interactive (\"rootname\" becomes the title of the plot):\ninter <- d3tree2( p ,  rootname = \"Workers\" )\n\n# save the widget\n# library(htmlwidgets)\n# saveWidget(inter, file=paste0( getwd(), \"/HtmlWidget/interactiveTreemap.html\"))\n```\n:::\n\n\n# Conclusions\n",
    "supporting": [
      "labor_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}