{
  "hash": "b373ebe36063c3996427a79799d09b5f",
  "result": {
    "markdown": "---\ntitle: \"Leaflet_tester\"\ndate: 06-30-2023\ncategories: [Data-Viz, openxlsx, stringr, fuzzyjoin, mapview, sf] # self-defined categories\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n---\n\n\nThis is a draft of a project for my father. I want to make sure the photo files structure renders properly online.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # who doesn't want to be tidy?\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggthemes) # more themes for ggplot\nlibrary(gt) # For nice tables\nlibrary(ggrepel) # to help position labels in ggplot graphs\nlibrary(openxlsx) # importing excel files from a URL\nlibrary(fuzzyjoin) # for joining on inexact matches\nlibrary(sf) # for handling geo data\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.9.3, GDAL 3.5.2, PROJ 8.2.1; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\nlibrary(mapview) # quick interactive mapping\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThe legacy packages maptools, rgdal, and rgeos, underpinning the sp package,\nwhich was just loaded, will retire in October 2023.\nPlease refer to R-spatial evolution reports for details, especially\nhttps://r-spatial.org/r/2023/05/15/evolution4.html.\nIt may be desirable to make the sf package available;\npackage maintainers should consider adding sf to Suggests:.\nThe sp package is now running under evolution status 2\n     (status 2 uses the sf package in place of rgdal)\n```\n:::\n\n```{.r .cell-code}\nlibrary(leaflet) # more mapping\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nhere() starts at C:/Users/drsin/OneDrive/Documents/R Projects/lsinks.github.io\n```\n:::\n\n```{.r .cell-code}\nblog_folder <- \"posts/2023-06-30-leaflet2\"\nphoto_folder = \"Photos\"\n# read in excel sheet\ntombstones <-\n  read.xlsx(here(blog_folder, \"Tombstone_Data_small.xlsx\"),\n    sheet = 1\n  )\n\n#converting to decimal latitude\ntombstones <- tombstones %>%\n  mutate(part1N = str_split_fixed(N, pattern = \" \", n = 2) ) %>%\n  mutate(N_degree = as.numeric(part1N[,1])) %>%\n  mutate(part2N = str_split_fixed(part1N[,2], pattern = '\\\\.', n = 2)) %>%\n  mutate(N_minute = as.numeric(part2N[,1])) %>%\n  mutate(N_second = as.numeric(part2N[,2])) %>%\n  mutate(lat = N_degree + N_minute/60 + N_second/3600)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `N_degree = as.numeric(part1N[, 1])`.\nCaused by warning:\n! NAs introduced by coercion\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `N_second = as.numeric(part2N[, 2])`.\nCaused by warning:\n! NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\n#converting to decimal longitude  \ntombstones <- tombstones %>%\n  mutate(part1W = str_split_fixed(W, pattern = \" \", n = 2) ) %>%\n  mutate(W_degree = as.numeric(part1W[,1])) %>%\n  mutate(part2W = str_split_fixed(part1W[,2], pattern = '\\\\.', n = 2)) %>%\n  mutate(W_minute = as.numeric(part2W[,1])) %>%\n  mutate(W_second = as.numeric(part2W[,2])) %>%\n  mutate(long = -(W_degree + W_minute/60 + W_second/3600)) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `W_degree = as.numeric(part1W[, 1])`.\nCaused by warning:\n! NAs introduced by coercion\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `W_second = as.numeric(part2W[, 2])`.\nCaused by warning:\n! NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\ntombstones <- tombstones %>%\n  select(-contains(\"part\"))\n\ntombstones <- tombstones %>%\n  mutate(full_name = paste(Surname, First.Name, sep = \" \"))\n```\n:::\n\n\nblah\n\n\n::: {.cell}\n\n```{.r .cell-code}\nphoto_names = list.files(here(blog_folder, photo_folder))\ndf = as.data.frame(photo_names)\n```\n:::\n\n\nblah\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntombstones_merged <- fuzzy_right_join(df, tombstones, \n                             by = c(\"photo_names\" = \"full_name\"),\n                             match_fun = str_detect)\n```\n:::\n\n\nblah\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# turn photo tag\n# turn photo tag\ntombstones_merged <- tombstones_merged %>%\n  drop_na(photo_names) %>%\n  mutate(tag = paste0(\"<img src=\", here(blog_folder, photo_folder, photo_names),\">\"))\n\n\ntombstones_merged <- tombstones_merged %>% drop_na(lat) %>% drop_na(long)\n\n\ntombstones_geo <- st_as_sf(tombstones_merged, coords = c(\"long\", \"lat\"), crs = 4326)\ntombstones_geo <- st_jitter(tombstones_geo, factor = 0.004)\n\nimage_list <- tombstones_geo$photo_names\n\nleaflet() %>%\n  addProviderTiles(providers$CartoDB.Positron) %>%\n  addCircleMarkers(\n    data = tombstones_geo,\n    label = ~ paste(First.Name, Surname, photo_names, sep = \" \"),\n   # popup = leafpop::popupImage(paste0(here(blog_folder, photo_folder),\"/\", image_list)),\n    clusterOptions = markerClusterOptions(),\n    opacity = 1,\n    radius = 5,\n    color = \"black\",\n    stroke = NA,\n    group = \"group1\"\n  )  %>%\n\n# popup = ~tag,\n\n\n   leafpop::addPopupImages(\n    image = paste0(here(blog_folder, photo_folder),\"/\", image_list),\n     src = local,\n     group = \"group1\",\n    width = 300, maxWidth = 300\n   )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-e87cf5336e74a86f8afe\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e87cf5336e74a86f8afe\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircleMarkers\",\"args\":[[37.98630959814705,37.9874043006557,38.09633164109495,38.11531103930487,38.105449517155,38.10184720811692,38.09314471512472,36.6479145346858,36.63633233768153,38.55501463020512,38.5508423148827,36.64235378719741,36.63504935277962,36.83072251168836,36.81988249989793,36.79837034454996,36.81796758994423,36.81380947173852,37.98051493000406,37.98718861687097,37.99754376906068,37.99122235436821,38.10717899684268,38.10430910592736,37.88567705217105],[-88.76618151672542,-88.77948861928149,-88.7025426543416,-88.68587741559243,-88.69195652053143,-88.70434502409938,-88.69062201623733,-86.98622232528139,-86.98911423070446,-87.18953294743164,-87.197172620816,-86.9896940362046,-86.98011416017314,-86.76623778829436,-86.76462772388584,-86.75994549842596,-86.75502997155387,-86.76102663958353,-88.86687612527535,-88.86813538035463,-88.86618711218063,-88.87352199904346,-88.688859772548,-88.70532376417285,-89.04151719723708],5,null,\"group1\",{\"interactive\":true,\"className\":\"\",\"stroke\":null,\"color\":\"black\",\"weight\":5,\"opacity\":1,\"fill\":true,\"fillColor\":\"black\",\"fillOpacity\":0.2},{\"showCoverageOnHover\":true,\"zoomToBoundsOnClick\":true,\"spiderfyOnMaxZoom\":true,\"removeOutsideVisibleBounds\":true,\"spiderLegPolylineOptions\":{\"weight\":1.5,\"color\":\"#222\",\"opacity\":0.5},\"freezeAtZoom\":false},null,null,null,[\"Zady Anderson Anderson Zady distance.JPG\",\"Zady Anderson Anderson Zady.JPG\",\"Albert Anderson Anderson Albert A.JPG\",\"Adesia Anderson Anderson Adesia.JPG\",\"E Anderson Anderson E Francis.JPG\",\"William Anderson Anderson William G.JPG\",\"Nancy Anderson Anderson Nancy A.JPG\",\"Richard Appleton Appleton Richard chalk.JPG\",\"Richard Appleton Appleton Richard.JPG\",\"William Baldwin Baldwin William chalk.JPG\",\"William Baldwin Baldwin William.JPG\",\"Mahalia Baggett Baggett Mahalia us J Wilson.JPG\",\"Mahalia Baggett Baggett Mahalia ux J Wilson.JPG\",\"E Beasley Beasley EC Chalk.JPG\",\"E Beasley Beasley EC No Chalk.JPG\",\"Fanning Beasley Beasley Fanning Chalk.JPG\",\"Fanning Beasley Beasley Fanning Distance.JPG\",\"Fanning Beasley Beasley Fanning No Chalk.JPG\",\"Clem Bundy Bundy Clem chalk.jpg\",\"Clem Bundy Bundy Clem.jpg\",\"Nancy Bundy Bundy Nancy chalk.jpg\",\"W Bundy Bundy WM chalk.jpg\",\"Thomas Bundy Bundy Thomas.JPG\",\"George Bundy Bundy George and Lora L.JPG\",\"W Burgess Burgess WJ.JPG\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"imagePopup\",\"args\":[[\"Anderson Zady distance.JPG\",\"Anderson Zady.JPG\",\"Anderson Albert A.JPG\",\"Anderson Adesia.JPG\",\"Anderson E Francis.JPG\",\"Anderson William G.JPG\",\"Anderson Nancy A.JPG\",\"Appleton Richard chalk.JPG\",\"Appleton Richard.JPG\",\"Baldwin William chalk.JPG\",\"Baldwin William.JPG\",\"Baggett Mahalia us J Wilson.JPG\",\"Baggett Mahalia ux J Wilson.JPG\",\"Beasley EC Chalk.JPG\",\"Beasley EC No Chalk.JPG\",\"Beasley Fanning Chalk.JPG\",\"Beasley Fanning Distance.JPG\",\"Beasley Fanning No Chalk.JPG\",\"Bundy Clem chalk.jpg\",\"Bundy Clem.jpg\",\"Bundy Nancy chalk.jpg\",\"Bundy WM chalk.jpg\",\"Bundy Thomas.JPG\",\"Bundy George and Lora L.JPG\",\"Burgess WJ.JPG\"],\"group1\",[300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300],[400,225,400,400,400,400,400,400,400,400,400,400,400,400,400,400,225,225,400,400,400,400,400,225,225],[\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\",\"l\"],[\"Anderson Zady distance\",\"Anderson Zady\",\"Anderson Albert A\",\"Anderson Adesia\",\"Anderson E Francis\",\"Anderson William G\",\"Anderson Nancy A\",\"Appleton Richard chalk\",\"Appleton Richard\",\"Baldwin William chalk\",\"Baldwin William\",\"Baggett Mahalia us J Wilson\",\"Baggett Mahalia ux J Wilson\",\"Beasley EC Chalk\",\"Beasley EC No Chalk\",\"Beasley Fanning Chalk\",\"Beasley Fanning Distance\",\"Beasley Fanning No Chalk\",\"Bundy Clem chalk\",\"Bundy Clem\",\"Bundy Nancy chalk\",\"Bundy WM chalk\",\"Bundy Thomas\",\"Bundy George and Lora L\",\"Burgess WJ\"],false,{\"maxWidth\":300,\"src\":[\"function (expr, envir = new.env()) \",\"eval.parent(substitute(eval(quote(expr), envir)))\"]}]}],\"limits\":{\"lat\":[36.63504935277962,38.55501463020512],\"lng\":[-89.04151719723708,-86.75502997155387]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/jquery-1.12.4/jquery.min.js\"></script>\r\n<link href=\"../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\r\n<link href=\"../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\r\n<script src=\"../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\r\n<link href=\"../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/leaflet-binding-2.1.2/leaflet.js\"></script>\r\n<script src=\"../../site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js\"></script>\r\n<script src=\"../../site_libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js\"></script>\r\n<link href=\"../../site_libs/leaflet-markercluster-1.0.5/MarkerCluster.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js\"></script>\r\n<script src=\"../../site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js\"></script>\r\n<script src=\"../../site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js\"></script>\r\n<script src=\"../../site_libs/popup-0.0.1/popup.js\"></script>\r\n<link id=\"image-group1-Anderson Zady distance-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Anderson Zady distance.JPG\"/>\r\n<link id=\"image-group1-Anderson Zady-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Anderson Zady.JPG\"/>\r\n<link id=\"image-group1-Anderson Albert A-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Anderson Albert A.JPG\"/>\r\n<link id=\"image-group1-Anderson Adesia-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Anderson Adesia.JPG\"/>\r\n<link id=\"image-group1-Anderson E Francis-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Anderson E Francis.JPG\"/>\r\n<link id=\"image-group1-Anderson William G-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Anderson William G.JPG\"/>\r\n<link id=\"image-group1-Anderson Nancy A-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Anderson Nancy A.JPG\"/>\r\n<link id=\"image-group1-Appleton Richard chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Appleton Richard chalk.JPG\"/>\r\n<link id=\"image-group1-Appleton Richard-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Appleton Richard.JPG\"/>\r\n<link id=\"image-group1-Baldwin William chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Baldwin William chalk.JPG\"/>\r\n<link id=\"image-group1-Baldwin William-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Baldwin William.JPG\"/>\r\n<link id=\"image-group1-Baggett Mahalia us J Wilson-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Baggett Mahalia us J Wilson.JPG\"/>\r\n<link id=\"image-group1-Baggett Mahalia ux J Wilson-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Baggett Mahalia ux J Wilson.JPG\"/>\r\n<link id=\"image-group1-Beasley EC Chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Beasley EC Chalk.JPG\"/>\r\n<link id=\"image-group1-Beasley EC No Chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Beasley EC No Chalk.JPG\"/>\r\n<link id=\"image-group1-Beasley Fanning Chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Beasley Fanning Chalk.JPG\"/>\r\n<link id=\"image-group1-Beasley Fanning Distance-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Beasley Fanning Distance.JPG\"/>\r\n<link id=\"image-group1-Beasley Fanning No Chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Beasley Fanning No Chalk.JPG\"/>\r\n<link id=\"image-group1-Bundy Clem chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Bundy Clem chalk.jpg\"/>\r\n<link id=\"image-group1-Bundy Clem-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Bundy Clem.jpg\"/>\r\n<link id=\"image-group1-Bundy Nancy chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Bundy Nancy chalk.jpg\"/>\r\n<link id=\"image-group1-Bundy WM chalk-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Bundy WM chalk.jpg\"/>\r\n<link id=\"image-group1-Bundy Thomas-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Bundy Thomas.JPG\"/>\r\n<link id=\"image-group1-Bundy George and Lora L-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Bundy George and Lora L.JPG\"/>\r\n<link id=\"image-group1-Burgess WJ-attachment\" rel=\"attachment\" href=\"../../site_libs/image-group1-0.0.1/Burgess WJ.JPG\"/>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}