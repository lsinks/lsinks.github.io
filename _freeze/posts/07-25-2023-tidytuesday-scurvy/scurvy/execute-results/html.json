{
  "hash": "7bbd6684ab0cac8b761d2889515cc32c",
  "result": {
    "markdown": "---\ntitle: \"A Heatmap of James Lind's Scurvy Study\"\ndescription: \"Making a Heatmap of James Lind's Scurvy Study using ggplot. Data cleaning and reformating handled through tidyverse packages.\"\ntwitter-card:\n  image: \"thumbnail.gif\"\nauthor:\n  - name: Louise E. Sinks\n    url: https://lsinks.github.io/\ndate: 07-17-2023\ncategories: [R, R-code, Code-Along, TidyTuesday, tidy, heatmap, ggplot, tidyverse, ggthemes] # self-defined categories\ncitation:\n  url: https://lsinks.github.io/posts/2023-07-11-tidytuesday-temps/temperatures\nimage: \"thumbnail.png\"\ndraft: true # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n---\n\n\nThis week's TidyTuesday concerns what some have called the first randomized clinical trial- a study by James Lind evaluating various treatments for scurvy.\n\n# Loading the Libraries and Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # who doesn't want to be tidy\nlibrary(gt) # nice tables\nlibrary(ggthemes) # more themes for ggplots\nlibrary(RColorBrewer) # color scales\n```\n:::\n\n\nLoading the TidyTuesday in the normal way.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntuesdata <- tidytuesdayR::tt_load(2023, week = 30)\n\nscurvy <- tuesdata$scurvy\n```\n:::\n\n\n# Reformat and Clean the data\n\nTake a look at the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy %>% gt()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"txzslrwvpr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#txzslrwvpr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#txzslrwvpr thead, #txzslrwvpr tbody, #txzslrwvpr tfoot, #txzslrwvpr tr, #txzslrwvpr td, #txzslrwvpr th {\n  border-style: none;\n}\n\n#txzslrwvpr p {\n  margin: 0;\n  padding: 0;\n}\n\n#txzslrwvpr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#txzslrwvpr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#txzslrwvpr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#txzslrwvpr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#txzslrwvpr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#txzslrwvpr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#txzslrwvpr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#txzslrwvpr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#txzslrwvpr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#txzslrwvpr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#txzslrwvpr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#txzslrwvpr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#txzslrwvpr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#txzslrwvpr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#txzslrwvpr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#txzslrwvpr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#txzslrwvpr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#txzslrwvpr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#txzslrwvpr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#txzslrwvpr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#txzslrwvpr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#txzslrwvpr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#txzslrwvpr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#txzslrwvpr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#txzslrwvpr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#txzslrwvpr .gt_left {\n  text-align: left;\n}\n\n#txzslrwvpr .gt_center {\n  text-align: center;\n}\n\n#txzslrwvpr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#txzslrwvpr .gt_font_normal {\n  font-weight: normal;\n}\n\n#txzslrwvpr .gt_font_bold {\n  font-weight: bold;\n}\n\n#txzslrwvpr .gt_font_italic {\n  font-style: italic;\n}\n\n#txzslrwvpr .gt_super {\n  font-size: 65%;\n}\n\n#txzslrwvpr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#txzslrwvpr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#txzslrwvpr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#txzslrwvpr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#txzslrwvpr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#txzslrwvpr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#txzslrwvpr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"study_id\">study_id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"treatment\">treatment</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dosing_regimen_for_scurvy\">dosing_regimen_for_scurvy</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"gum_rot_d6\">gum_rot_d6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"skin_sores_d6\">skin_sores_d6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"weakness_of_the_knees_d6\">weakness_of_the_knees_d6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"lassitude_d6\">lassitude_d6</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"fit_for_duty_d6\">fit_for_duty_d6</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">1</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">cider</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">1 quart per day</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">2_moderate</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">2_moderate</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">2_moderate</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">2_moderate</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">2</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">cider</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">1 quart per day</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">2_moderate</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">1_mild</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">2_moderate</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">3</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">dilute_sulfuric_acid</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">25 drops of elixir of vitriol, three times a day</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">1_mild</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">4</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">dilute_sulfuric_acid</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">25 drops of elixir of vitriol, three times a day</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">2_moderate</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">5</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">vinegar</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">two spoonfuls, three times daily</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">6</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">vinegar</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">two spoonfuls, three times daily</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">7</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">sea_water</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">half pint daily</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">8</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">sea_water</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">half pint daily</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">9</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">citrus</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">two lemons and an orange daily</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">1_mild</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">1_mild</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">0_none</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">1_mild</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">10</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">citrus</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">two lemons and an orange daily</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">0_none</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">0_none</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">0_none</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">0_none</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">1_yes</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">11</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">purgative_mixture</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">a nutmeg-sized paste of garlic, mustard seed, horseradish, balsam of Peru, and gum myrrh three times a day</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n    <tr><td headers=\"study_id\" class=\"gt_row gt_right\">12</td>\n<td headers=\"treatment\" class=\"gt_row gt_left\">purgative_mixture</td>\n<td headers=\"dosing_regimen_for_scurvy\" class=\"gt_row gt_left\">a nutmeg-sized paste of garlic, mustard seed, horseradish, balsam of Peru, and gum myrrh three times a day</td>\n<td headers=\"gum_rot_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"skin_sores_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"weakness_of_the_knees_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"lassitude_d6\" class=\"gt_row gt_left\">3_severe</td>\n<td headers=\"fit_for_duty_d6\" class=\"gt_row gt_left\">0_no</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nSmall data set, maybe best as a table.\n\nFirst some cleanup. First, I'm replacing all the underscores (\"\\_\") in the treatment descriptions with spaces. I use `str_replace_all()` from stringr inside a `mutate()` for that.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy <- scurvy %>%\n  mutate(treatment = str_replace_all(treatment, \"_\", \" \"))\n```\n:::\n\n\n# Reshaping the Data with `pivot_longer()`\n\nA heatmap is like a table, but a bit more visually interesting. I'd like to plot the treatment vs. the symptoms. To do so, the data needs to be reshaped into the long format. This is easily done using pivot_longer() from tidyr. Here, I give it the name of the two new columns, symptom and severity. The symptom column will contain the values gum rot, skin sores, etc. that are currently fields. The severity column will contain the likert scale rating for that symptom (1- mild, 2- moderate, 3- severe). I'm also going to split those ratings into a numerical (1, 2, 3) and descriptive (\"mild\", \"moderate\", \"severe\") rating using `separate()` from tidyr.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy2 <- scurvy %>%\n  pivot_longer(4:7, names_to = \"symptom\", values_to = \"severity\") %>%\n  separate(\n    severity,\n    sep = \"_\",\n    into = c(\"Numerical_Severity\", \"Descriptive_Severity\")\n  )\n```\n:::\n\n\nNow, I want to get rid of the day 6 label (d6) from the symptom. There are no other time points, so the data is somewhat extraneous. Here I'm using `separate_wider_delim()`. This is actually the active/ recommended separate function in tidyr. Both separate() and extract() still work, but it is recommended that users switch to the new family of separate functions. Instead of into for the new column names, this function uses names. The list of names can contain NA for sections that you wish to discard. Here, I throw away the second section (\\_d6*).* Then I use str_replace_all() to clean out the rest of the underscores in the symptom names. Note that if I did this step first, I'd need a different delimiter. I generally like to do any separations before I do str_replace() because you are more likely to have a unique separator/delimiter before you clean up special symbols.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy2 <- scurvy2 %>%\n  separate_wider_delim(symptom, delim = \"_d6\", names = c(\"symptom\", NA)) %>%\n  mutate(symptom = str_replace_all(symptom, \"_\", \" \"))\n```\n:::\n\n\n# Making the Heatmap\n\nI never remember the color palette names, so here they are. The par(cex = 0.5) command is a base R method of changing the parameters for the next plot. The cex parameter controls the text size. [There are a lot of palettes, so if you don't do this the labels will be squished](https://bio304-class.github.io/bio304-book/data-wrangling-part-ii.html).\n\n## Choosing a Color Palette\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(cex = 0.5) \ndisplay.brewer.all()  \n```\n\n::: {.cell-output-display}\n![](scurvy_files/figure-html/looking-at-brewer-palettes-1.png){width=672}\n:::\n:::\n\n\n## First Draft of the Heatmap\n\nAnd the first draft of the heatmap. I'm coloring the heatmap by numerical severity and I'm labeling it with the descriptive severity.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(scurvy2, aes(treatment, symptom)) +   \n  geom_tile(aes(fill = Numerical_Severity))  +\n  geom_text(aes(label = Descriptive_Severity)) +\n  scale_fill_brewer(palette = \"YlOrRd\")\n```\n\n::: {.cell-output-display}\n![](scurvy_files/figure-html/draft-heatmap-1.png){width=672}\n:::\n:::\n\n\nOh, that is ugly. And ggplot grouped all the treatments, so we have overlapping text labels.\n\n## Plotting by `study_id`\n\nLet's fix things up. First, plot by study_id instead of treatment group. That will get me back to the 12 patients. And the legend should be removed. This is done using `theme(legend.position = \"none\")`. I'm also going to flip x and y. Since there are only 4 symptoms, this will give the text labels (mild, moderate, severe) more space since there will only be 4 labels across instead of 12.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy_heatmap <- ggplot(scurvy2, aes(symptom, study_id)) +   \n  geom_tile(aes(fill = Numerical_Severity))  +\n  geom_text(aes(label = Descriptive_Severity)) +\n  scale_fill_brewer(palette = \"YlOrRd\") +\n  theme(legend.position = \"none\") \n\nscurvy_heatmap\n```\n\n::: {.cell-output-display}\n![](scurvy_files/figure-html/changing-to-studyid-1.png){width=672}\n:::\n:::\n\n\n## Mapping `study_id` Back to Treatments\n\nNow I need to get back to the treatment groups. The original data frame, scurvy, has the treatment groups matched to the patient_id. The mapping can be done using `scale_x_continuous(breaks = 1:12, labels = scurvy$treatment)`. This is pretty non-intuitive to me;[I found this suggestion on Stackoverflow](https://stackoverflow.com/questions/66985722/ggplot-change-y-axis-numeric-values-to-text).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy_heatmap <- scurvy_heatmap +\n  scale_y_continuous(breaks = 1:12, labels = scurvy$treatment)\n\nscurvy_heatmap\n```\n\n::: {.cell-output-display}\n![](scurvy_files/figure-html/mapping-studyid-to-treament-1.png){width=672}\n:::\n:::\n\n\n## Modifying the Style with `theme()`\n\nNow tweak the theme to clean things up. First, I'm going to start with a theme that is closest to want I want. In this case, I went with theme_void(), which actually removes all the elements. I then add the few I want back in. There is so much stuff to remove (the axis, the grid marks, the gray background). I want to retain the axis title and text. I'll add the titles and captions too.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy_heatmap <- scurvy_heatmap +\n  theme_void() +\n  theme(axis.text = element_text(size = 10),\n        axis.title = element_text(face = 'bold')) +\n  labs(title = \"James Lind's Study of Scurvy Treatments- 1757\", caption = \"data from medicaldata R package\") +\n  ylab('Treatments') + xlab('Symptoms') +\n  theme(axis.text.x = element_text(angle = 45))\n  \nscurvy_heatmap\n```\n\n::: {.cell-output-display}\n![](scurvy_files/figure-html/tweaking-the-style-with-theme-1.png){width=672}\n:::\n:::\n\n\n## `theme_void()` Isn't Completely Empty!\n\nAnd the legend came back... Apparently, theme_void does include the legend, so it re-spawned. This is a bit surprising, since the [description says \"A completely empty theme.\"](https://ggplot2.tidyverse.org/reference/ggtheme.html)\n\nI'm going to quickly test this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(scurvy2, aes(treatment, symptom)) + \n  geom_tile(aes(fill = Numerical_Severity)) +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](scurvy_files/figure-html/ugly-themevoid-heatmap-1.png){width=672}\n:::\n:::\n\n\n## Final Heatmap\n\nOkay, so not a big deal to remove this again. The y axis label also rotated, so that needs to be rotated back.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscurvy_heatmap <- scurvy_heatmap +\ntheme(legend.position = \"none\") +\n  theme(axis.title.y = element_text(angle = 90))\n\nscurvy_heatmap\n```\n\n::: {.cell-output-display}\n![](scurvy_files/figure-html/final-heatmap-1.png){width=672}\n:::\n:::\n\n\n# Thoughts about Scurvy\n\nDespite having experimental evidence that fresh citrus was effective in treating scurvy, James Lind recommended other treatments and preparations in his book. Of particular note is a concentrate of citrus juices that could be bottled and stored indefinitely. Vitamin C is very unstable; the processing and storage removed almost all the vitamin C from the juice. This is covered in a [fascinating paper by R. E. Hughes](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1081662/pdf/medhist00113-0029.pdf), where he prepared and measured the vitamin C levels in various treatments recommended by Lind. Hughes does touch on the issue of cider. Lind's data seems to suggest that cider was moderately effective as a treatment. Fermentation and aging does degrade vitamin C, so the cider likely did not have more than trace amounts of vitamin C. I suspect there was still some and perhaps enough to mitigate some of the worst impacts of scurvy.\n",
    "supporting": [
      "scurvy_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}