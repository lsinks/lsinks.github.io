<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Louise E. Sinks">
<meta name="dcterms.date" content="2023-07-25">
<meta name="description" content="Making a Heatmap of James Lind’s Scurvy Study using ggplot. Data cleaning and reformating handled through tidyverse packages.">

<title>Louise E. Sinks - A Heatmap of James Lind’s Scurvy Study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-WR4VFC0MC2"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-WR4VFC0MC2', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Louise E. Sinks - A Heatmap of James Lind’s Scurvy Study">
<meta name="twitter:description" content="Making a Heatmap of James Lind’s Scurvy Study using ggplot. Data cleaning and reformating handled through tidyverse packages.">
<meta name="twitter:image" content="https://lsinks.github.io/posts/2023-07-25-tidytuesday-scurvy/thumbnail.png">
<meta name="twitter:creator" content="@LouiseSinks">
<meta name="twitter:image-height" content="1499">
<meta name="twitter:image-width" content="2100">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Louise E. Sinks</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About Me/ CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html" rel="" target="">
 <span class="menu-text">Blog Entries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../currentprojects.html" rel="" target="">
 <span class="menu-text">Current Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blogroll.html" rel="" target="">
 <span class="menu-text">Blog Roll</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../posts.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-the-libraries-and-data" id="toc-loading-the-libraries-and-data" class="nav-link active" data-scroll-target="#loading-the-libraries-and-data">Loading the Libraries and Data</a></li>
  <li><a href="#reformat-and-clean-the-data" id="toc-reformat-and-clean-the-data" class="nav-link" data-scroll-target="#reformat-and-clean-the-data">Reformat and Clean the data</a></li>
  <li><a href="#reshaping-the-data-with-pivot_longer" id="toc-reshaping-the-data-with-pivot_longer" class="nav-link" data-scroll-target="#reshaping-the-data-with-pivot_longer">Reshaping the Data with <code>pivot_longer()</code></a></li>
  <li><a href="#making-the-heatmap" id="toc-making-the-heatmap" class="nav-link" data-scroll-target="#making-the-heatmap">Making the Heatmap</a>
  <ul class="collapse">
  <li><a href="#choosing-a-color-palette" id="toc-choosing-a-color-palette" class="nav-link" data-scroll-target="#choosing-a-color-palette">Choosing a Color Palette</a></li>
  <li><a href="#first-draft-of-the-heatmap" id="toc-first-draft-of-the-heatmap" class="nav-link" data-scroll-target="#first-draft-of-the-heatmap">First Draft of the Heatmap</a></li>
  <li><a href="#plotting-by-study_id" id="toc-plotting-by-study_id" class="nav-link" data-scroll-target="#plotting-by-study_id">Plotting by <code>study_id</code></a></li>
  <li><a href="#mapping-study_id-back-to-treatments" id="toc-mapping-study_id-back-to-treatments" class="nav-link" data-scroll-target="#mapping-study_id-back-to-treatments">Mapping <code>study_id</code> Back to Treatments</a></li>
  <li><a href="#modifying-the-style-with-theme" id="toc-modifying-the-style-with-theme" class="nav-link" data-scroll-target="#modifying-the-style-with-theme">Modifying the Style with <code>theme()</code></a></li>
  <li><a href="#theme_void-isnt-completely-empty" id="toc-theme_void-isnt-completely-empty" class="nav-link" data-scroll-target="#theme_void-isnt-completely-empty"><code>theme_void()</code> Isn’t Completely Empty!</a></li>
  <li><a href="#final-heatmap" id="toc-final-heatmap" class="nav-link" data-scroll-target="#final-heatmap">Final Heatmap</a></li>
  </ul></li>
  <li><a href="#thoughts-about-scurvy" id="toc-thoughts-about-scurvy" class="nav-link" data-scroll-target="#thoughts-about-scurvy">Thoughts about Scurvy</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Heatmap of James Lind’s Scurvy Study</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">R-code</div>
    <div class="quarto-category">Code-Along</div>
    <div class="quarto-category">TidyTuesday</div>
    <div class="quarto-category">tidy</div>
    <div class="quarto-category">heatmap</div>
    <div class="quarto-category">ggplot</div>
    <div class="quarto-category">tidyverse</div>
    <div class="quarto-category">ggthemes</div>
  </div>
  </div>

<div>
  <div class="description">
    Making a Heatmap of James Lind’s Scurvy Study using ggplot. Data cleaning and reformating handled through tidyverse packages.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://lsinks.github.io/">Louise E. Sinks</a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 25, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>This week’s <a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a> concerns what some have called the first randomized clinical trial- a study by James Lind evaluating various treatments for scurvy. This data has been collected into the <a href="https://higgi13425.github.io/medicaldata/">medicaldata R package</a> from <a href="https://www.google.com/books/edition/A_Treatise_on_the_Scurvy/oP1UEXWU7fsC?hl=en&amp;gbpv=1&amp;printsec=frontcover">Lind’s book on scurvy</a>.</p>
<section id="loading-the-libraries-and-data" class="level1">
<h1>Loading the Libraries and Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># who doesn't want to be tidy</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># nice tables</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes) <span class="co"># more themes for ggplots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) <span class="co"># color scales</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># consistent method for working in file structure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Loading the TidyTuesday in the normal way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tuesdata <span class="ot">&lt;-</span> tidytuesdayR<span class="sc">::</span><span class="fu">tt_load</span>(<span class="dv">2023</span>, <span class="at">week =</span> <span class="dv">30</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>scurvy <span class="ot">&lt;-</span> tuesdata<span class="sc">$</span>scurvy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reformat-and-clean-the-data" class="level1">
<h1>Reformat and Clean the data</h1>
<p>Take a look at the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>scurvy <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ufoktbwmgj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ufoktbwmgj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ufoktbwmgj thead, #ufoktbwmgj tbody, #ufoktbwmgj tfoot, #ufoktbwmgj tr, #ufoktbwmgj td, #ufoktbwmgj th {
  border-style: none;
}

#ufoktbwmgj p {
  margin: 0;
  padding: 0;
}

#ufoktbwmgj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ufoktbwmgj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ufoktbwmgj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ufoktbwmgj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ufoktbwmgj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ufoktbwmgj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ufoktbwmgj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ufoktbwmgj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ufoktbwmgj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ufoktbwmgj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ufoktbwmgj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ufoktbwmgj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ufoktbwmgj .gt_spanner_row {
  border-bottom-style: hidden;
}

#ufoktbwmgj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ufoktbwmgj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ufoktbwmgj .gt_from_md > :first-child {
  margin-top: 0;
}

#ufoktbwmgj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ufoktbwmgj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ufoktbwmgj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ufoktbwmgj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ufoktbwmgj .gt_row_group_first td {
  border-top-width: 2px;
}

#ufoktbwmgj .gt_row_group_first th {
  border-top-width: 2px;
}

#ufoktbwmgj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ufoktbwmgj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ufoktbwmgj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ufoktbwmgj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ufoktbwmgj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ufoktbwmgj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ufoktbwmgj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ufoktbwmgj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ufoktbwmgj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ufoktbwmgj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ufoktbwmgj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ufoktbwmgj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ufoktbwmgj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ufoktbwmgj .gt_left {
  text-align: left;
}

#ufoktbwmgj .gt_center {
  text-align: center;
}

#ufoktbwmgj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ufoktbwmgj .gt_font_normal {
  font-weight: normal;
}

#ufoktbwmgj .gt_font_bold {
  font-weight: bold;
}

#ufoktbwmgj .gt_font_italic {
  font-style: italic;
}

#ufoktbwmgj .gt_super {
  font-size: 65%;
}

#ufoktbwmgj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ufoktbwmgj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ufoktbwmgj .gt_indent_1 {
  text-indent: 5px;
}

#ufoktbwmgj .gt_indent_2 {
  text-indent: 10px;
}

#ufoktbwmgj .gt_indent_3 {
  text-indent: 15px;
}

#ufoktbwmgj .gt_indent_4 {
  text-indent: 20px;
}

#ufoktbwmgj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="study_id">study_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="treatment">treatment</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="dosing_regimen_for_scurvy">dosing_regimen_for_scurvy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="gum_rot_d6">gum_rot_d6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="skin_sores_d6">skin_sores_d6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="weakness_of_the_knees_d6">weakness_of_the_knees_d6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="lassitude_d6">lassitude_d6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="fit_for_duty_d6">fit_for_duty_d6</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="study_id" class="gt_row gt_right">1</td>
<td headers="treatment" class="gt_row gt_left">cider</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">1 quart per day</td>
<td headers="gum_rot_d6" class="gt_row gt_left">2_moderate</td>
<td headers="skin_sores_d6" class="gt_row gt_left">2_moderate</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">2_moderate</td>
<td headers="lassitude_d6" class="gt_row gt_left">2_moderate</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">2</td>
<td headers="treatment" class="gt_row gt_left">cider</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">1 quart per day</td>
<td headers="gum_rot_d6" class="gt_row gt_left">2_moderate</td>
<td headers="skin_sores_d6" class="gt_row gt_left">1_mild</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">2_moderate</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">3</td>
<td headers="treatment" class="gt_row gt_left">dilute_sulfuric_acid</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">25 drops of elixir of vitriol, three times a day</td>
<td headers="gum_rot_d6" class="gt_row gt_left">1_mild</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">4</td>
<td headers="treatment" class="gt_row gt_left">dilute_sulfuric_acid</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">25 drops of elixir of vitriol, three times a day</td>
<td headers="gum_rot_d6" class="gt_row gt_left">2_moderate</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">5</td>
<td headers="treatment" class="gt_row gt_left">vinegar</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">two spoonfuls, three times daily</td>
<td headers="gum_rot_d6" class="gt_row gt_left">3_severe</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">6</td>
<td headers="treatment" class="gt_row gt_left">vinegar</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">two spoonfuls, three times daily</td>
<td headers="gum_rot_d6" class="gt_row gt_left">3_severe</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">7</td>
<td headers="treatment" class="gt_row gt_left">sea_water</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">half pint daily</td>
<td headers="gum_rot_d6" class="gt_row gt_left">3_severe</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">8</td>
<td headers="treatment" class="gt_row gt_left">sea_water</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">half pint daily</td>
<td headers="gum_rot_d6" class="gt_row gt_left">3_severe</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">9</td>
<td headers="treatment" class="gt_row gt_left">citrus</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">two lemons and an orange daily</td>
<td headers="gum_rot_d6" class="gt_row gt_left">1_mild</td>
<td headers="skin_sores_d6" class="gt_row gt_left">1_mild</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">0_none</td>
<td headers="lassitude_d6" class="gt_row gt_left">1_mild</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">10</td>
<td headers="treatment" class="gt_row gt_left">citrus</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">two lemons and an orange daily</td>
<td headers="gum_rot_d6" class="gt_row gt_left">0_none</td>
<td headers="skin_sores_d6" class="gt_row gt_left">0_none</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">0_none</td>
<td headers="lassitude_d6" class="gt_row gt_left">0_none</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">1_yes</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">11</td>
<td headers="treatment" class="gt_row gt_left">purgative_mixture</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">a nutmeg-sized paste of garlic, mustard seed, horseradish, balsam of Peru, and gum myrrh three times a day</td>
<td headers="gum_rot_d6" class="gt_row gt_left">3_severe</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
    <tr><td headers="study_id" class="gt_row gt_right">12</td>
<td headers="treatment" class="gt_row gt_left">purgative_mixture</td>
<td headers="dosing_regimen_for_scurvy" class="gt_row gt_left">a nutmeg-sized paste of garlic, mustard seed, horseradish, balsam of Peru, and gum myrrh three times a day</td>
<td headers="gum_rot_d6" class="gt_row gt_left">3_severe</td>
<td headers="skin_sores_d6" class="gt_row gt_left">3_severe</td>
<td headers="weakness_of_the_knees_d6" class="gt_row gt_left">3_severe</td>
<td headers="lassitude_d6" class="gt_row gt_left">3_severe</td>
<td headers="fit_for_duty_d6" class="gt_row gt_left">0_no</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Small data set, maybe best as a table.</p>
<p>First some cleanup. First, I’m replacing all the underscores (“_”) in the treatment descriptions with spaces. I use <code>str_replace_all()</code> from stringr inside a <code>mutate()</code> for that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>scurvy <span class="ot">&lt;-</span> scurvy <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">str_replace_all</span>(treatment, <span class="st">"_"</span>, <span class="st">" "</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reshaping-the-data-with-pivot_longer" class="level1">
<h1>Reshaping the Data with <code>pivot_longer()</code></h1>
<p>A heatmap is like a table, but a bit more visually interesting. I’d like to plot the treatment vs.&nbsp;the symptoms. To do so, the data needs to be reshaped into the long format. This is easily done using pivot_longer() from tidyr. Here, I give it the name of the two new columns, symptom and severity. The symptom column will contain the values gum rot, skin sores, etc. that are currently fields. The severity column will contain the likert scale rating for that symptom (1- mild, 2- moderate, 3- severe). I’m also going to split those ratings into a numerical (1, 2, 3) and descriptive (“mild”, “moderate”, “severe”) rating using <code>separate()</code> from tidyr.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>scurvy2 <span class="ot">&lt;-</span> scurvy <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">names_to =</span> <span class="st">"symptom"</span>, <span class="at">values_to =</span> <span class="st">"severity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    severity,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">"_"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"Numerical_Severity"</span>, <span class="st">"Descriptive_Severity"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, I want to get rid of the day 6 label (d6) from the symptom. There are no other time points, so the data is somewhat extraneous. Here I’m using <code>separate_wider_delim()</code>. This is actually the active/ recommended separate function in tidyr. Both separate() and extract() still work, but it is recommended that users switch to the new family of separate functions. Instead of into for the new column names, this function uses names. The list of names can contain NA for sections that you wish to discard. Here, I throw away the second section (_d6<em>).</em> Then I use str_replace_all() to clean out the rest of the underscores in the symptom names. Note that if I did this step first, I’d need a different delimiter. I generally like to do any separations before I do str_replace() because you are more likely to have a unique separator/delimiter before you clean up special symbols.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>scurvy2 <span class="ot">&lt;-</span> scurvy2 <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_delim</span>(symptom, <span class="at">delim =</span> <span class="st">"_d6"</span>, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"symptom"</span>, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">symptom =</span> <span class="fu">str_replace_all</span>(symptom, <span class="st">"_"</span>, <span class="st">" "</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="making-the-heatmap" class="level1">
<h1>Making the Heatmap</h1>
<p>I never remember the color palette names, so here they are. The par(cex = 0.5) command is a base R method of changing the parameters for the next plot. The cex parameter controls the text size. <a href="https://bio304-class.github.io/bio304-book/data-wrangling-part-ii.html">There are a lot of palettes, so if you don’t do this the labels will be squished</a>.</p>
<section id="choosing-a-color-palette" class="level2">
<h2 class="anchored" data-anchor-id="choosing-a-color-palette">Choosing a Color Palette</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex =</span> <span class="fl">0.5</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="scurvy_files/figure-html/looking-at-brewer-palettes-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="first-draft-of-the-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="first-draft-of-the-heatmap">First Draft of the Heatmap</h2>
<p>And the first draft of the heatmap. I’m coloring the heatmap by numerical severity and I’m labeling it with the descriptive severity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scurvy2, <span class="fu">aes</span>(treatment, symptom)) <span class="sc">+</span>   </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Numerical_Severity))  <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Descriptive_Severity)) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="scurvy_files/figure-html/draft-heatmap-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Oh, that is ugly. And ggplot grouped all the treatments, so we have overlapping text labels.</p>
</section>
<section id="plotting-by-study_id" class="level2">
<h2 class="anchored" data-anchor-id="plotting-by-study_id">Plotting by <code>study_id</code></h2>
<p>Let’s fix things up. First, plot by study_id instead of treatment group. That will get me back to the 12 patients. And the legend should be removed. This is done using <code>theme(legend.position = "none")</code>. I’m also going to flip x and y. Since there are only 4 symptoms, this will give the text labels (mild, moderate, severe) more space since there will only be 4 labels across instead of 12.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scurvy2, <span class="fu">aes</span>(symptom, study_id)) <span class="sc">+</span>   </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Numerical_Severity))  <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Descriptive_Severity)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"YlOrRd"</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="scurvy_files/figure-html/changing-to-studyid-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mapping-study_id-back-to-treatments" class="level2">
<h2 class="anchored" data-anchor-id="mapping-study_id-back-to-treatments">Mapping <code>study_id</code> Back to Treatments</h2>
<p>Now I need to get back to the treatment groups. The original data frame, scurvy, has the treatment groups matched to the patient_id. The mapping can be done using <code>scale_x_continuous(breaks = 1:12, labels = scurvy$treatment)</code>. This is pretty non-intuitive to me;<a href="https://stackoverflow.com/questions/66985722/ggplot-change-y-axis-numeric-values-to-text">I found this suggestion on Stackoverflow</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap <span class="ot">&lt;-</span> scurvy_heatmap <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">labels =</span> scurvy<span class="sc">$</span>treatment)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="scurvy_files/figure-html/mapping-studyid-to-treament-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modifying-the-style-with-theme" class="level2">
<h2 class="anchored" data-anchor-id="modifying-the-style-with-theme">Modifying the Style with <code>theme()</code></h2>
<p>Now tweak the theme to clean things up. First, I’m going to start with a theme that is closest to want I want. In this case, I went with theme_void(), which actually removes all the elements. I then add the few I want back in. There is so much stuff to remove (the axis, the grid marks, the gray background). I want to retain the axis title and text. I’ll add the titles and captions too.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap <span class="ot">&lt;-</span> scurvy_heatmap <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">'bold'</span>)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"James Lind's Study of Scurvy Treatments- 1757"</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"data from medicaldata R package"</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Results at Day 6"</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'Treatments'</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">'Symptoms'</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="scurvy_files/figure-html/tweaking-the-style-with-theme-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="theme_void-isnt-completely-empty" class="level2">
<h2 class="anchored" data-anchor-id="theme_void-isnt-completely-empty"><code>theme_void()</code> Isn’t Completely Empty!</h2>
<p>And the legend came back… Apparently, theme_void does include the legend, so it re-spawned. This is a bit surprising, since the <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">description says “A completely empty theme.”</a></p>
<p>I’m going to quickly test this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(scurvy2, <span class="fu">aes</span>(treatment, symptom)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Numerical_Severity)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="scurvy_files/figure-html/ugly-themevoid-heatmap-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="final-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="final-heatmap">Final Heatmap</h2>
<p>Okay, so not a big deal to remove this again. The y axis label also rotated, so that needs to be rotated back.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap <span class="ot">&lt;-</span> scurvy_heatmap <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>scurvy_heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="scurvy_files/figure-html/final-heatmap-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"post"</span>, <span class="st">"2023-07-tidytuesday-scurvy"</span>, <span class="st">"thumbnail.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
</section>
<section id="thoughts-about-scurvy" class="level1">
<h1>Thoughts about Scurvy</h1>
<p>Despite having experimental evidence that fresh citrus was effective in treating scurvy, James Lind recommended other treatments and preparations in his book. Of particular note is a concentrate of citrus juices that could be bottled and stored indefinitely. Vitamin C is very unstable; the processing and storage removed almost all the vitamin C from the juice. This is covered in a <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1081662/pdf/medhist00113-0029.pdf">fascinating paper by R. E. Hughes</a>, where he prepared and measured the vitamin C levels in various treatments recommended by Lind. Hughes does touch on the issue of cider. Lind’s data seems to suggest that cider was moderately effective as a treatment. Fermentation and aging does degrade vitamin C, so the cider likely did not have more than trace amounts of vitamin C. I suspect there was still some and perhaps enough to mitigate some of the worst impacts of scurvy.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{e. sinks2023,
  author = {E. Sinks, Louise},
  title = {A {Heatmap} of {James} {Lind’s} {Scurvy} {Study}},
  date = {2023-07-25},
  url = {https://lsinks.github.io/posts/2023-07-25-tidytuesday-scurvy/scurvy},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-e. sinks2023" class="csl-entry quarto-appendix-citeas" role="listitem">
E. Sinks, Louise. 2023. <span>“A Heatmap of James Lind’s Scurvy
Study.”</span> July 25, 2023. <a href="https://lsinks.github.io/posts/2023-07-25-tidytuesday-scurvy/scurvy">https://lsinks.github.io/posts/2023-07-25-tidytuesday-scurvy/scurvy</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="lsinks/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>